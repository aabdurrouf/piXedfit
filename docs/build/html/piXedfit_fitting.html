

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>piXedfit_fitting &mdash; piXedfit 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="piXedfit_analysis" href="piXedfit_analysis.html" />
    <link rel="prev" title="piXedfit_model" href="piXedfit_model.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> piXedfit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="manage_filters.html">Managing filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="list_imaging_data.html">List of imaging data</a></li>
<li class="toctree-l1"><a class="reference internal" href="list_kernels_psf.html">Convolution kernels and PSFs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ingredients_model.html">SED modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="gen_model_SEDs.html">Generating model SEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_pros.html">Image processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_ifs_match.html">Spatial and Spectral Matching of imaging and IFS data</a></li>
<li class="toctree-l1"><a class="reference internal" href="pixel_binning.html">Pixel binning</a></li>
<li class="toctree-l1"><a class="reference internal" href="fit_ing_SEDs.html">Fitting individual SED</a></li>
<li class="toctree-l1"><a class="reference internal" href="fit_res_SEDs.html">Fitting spatially resolved SEDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_fitres.html">Analyzing fitting results</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_maps_prop.html">Get maps of spatially resolved properties</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Demonstrations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="demos_pixel_binning.html">Pixel binning</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos_sed_fitting.html">SED fitting</a></li>
</ul>
<p class="caption"><span class="caption-text">API reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="piXedfit_images.html">piXedfit_images</a></li>
<li class="toctree-l1"><a class="reference internal" href="piXedfit_spectrophotometric.html">piXedfit_spectrophotometric</a></li>
<li class="toctree-l1"><a class="reference internal" href="piXedfit_bin.html">piXedfit_bin</a></li>
<li class="toctree-l1"><a class="reference internal" href="piXedfit_model.html">piXedfit_model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">piXedfit_fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="piXedfit_analysis.html">piXedfit_analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">piXedfit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>piXedfit_fitting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/piXedfit_fitting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-piXedfit.piXedfit_fitting">
<span id="pixedfit-fitting"></span><span id="api-fitting"></span><h1>piXedfit_fitting<a class="headerlink" href="#module-piXedfit.piXedfit_fitting" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="piXedfit.piXedfit_fitting.SEDfit_from_binmap">
<code class="sig-prename descclassname">piXedfit.piXedfit_fitting.</code><code class="sig-name descname">SEDfit_from_binmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fits_binmap</span></em>, <em class="sig-param"><span class="n">binid_range</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">bin_ids</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">models_spec</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fit_method</span><span class="o">=</span><span class="default_value">'mcmc'</span></em>, <em class="sig-param"><span class="n">gal_z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">z_range</span><span class="o">=</span><span class="default_value">[0.0, 1.0]</span></em>, <em class="sig-param"><span class="n">nrands_z</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">add_igm_absorption</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">igm_type</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">likelihood</span><span class="o">=</span><span class="default_value">'gauss'</span></em>, <em class="sig-param"><span class="n">dof</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">gauss_likelihood_form</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">nwalkers</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">nsteps</span><span class="o">=</span><span class="default_value">600</span></em>, <em class="sig-param"><span class="n">nsteps_cut</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">nproc</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">perc_chi2</span><span class="o">=</span><span class="default_value">90.0</span></em>, <em class="sig-param"><span class="n">cosmo</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">H0</span><span class="o">=</span><span class="default_value">70.0</span></em>, <em class="sig-param"><span class="n">Om0</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">store_full_samplers</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">name_out_fits</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#piXedfit.piXedfit_fitting.SEDfit_from_binmap" title="Permalink to this definition">¶</a></dt>
<dd><p>A function for performing SED fitting to set of spatially resolved SEDs from the reduced data cube that is produced after the pixel binning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_binmap</strong> – Input FITS file of reduced data cube after pixel binning. This FITS file is the one that is output by <code class="xref py py-func docutils literal notranslate"><span class="pre">pixel_binning_photo()</span></code> function in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">piXedfit_bin</span></code> module.
This is a mandatory parameter.</p></li>
<li><p><strong>binid_range</strong> – Range of bin IDs that are going to be fit. Allowed format is [idmin,idmax]. The id starts from 0. If empty, [], fitting will be done to SEDs of all spatial bins.</p></li>
<li><p><strong>bin_ids</strong> – Bin ids whose the SEDs are going to be fit. Allowed format is a 1D array. The id starts from 0. Both binid_range and bin_ids can’t be empty, []. If both of them are not empty, the bin_ids will be used.</p></li>
<li><p><strong>models_spec</strong> – (Mandatory)</p></li>
<li><p><strong>fit_method</strong> – (default: ‘mcmc’)
Choice for the fitting method. Options are: (1)’mcmc’, and (2)’rdsps’.</p></li>
<li><p><strong>gal_z</strong> – Redshift of the galaxy. If gal_z=None, then redshift is taken from the header of the FITS file.
If gal_z in the FITS file header is negatiive, then redshift is set to be free.</p></li>
<li><p><strong>z_range</strong> – (default: [0.0,1.0])</p></li>
<li><p><strong>nrands_z</strong> – (default: 10)</p></li>
<li><p><strong>add_igm_absorption</strong> – (default: 0)
Switch for the IGM absorption. Options are: (1)0 means turn off, and (2)1 means turn on.</p></li>
<li><p><strong>igm_type</strong> – (default: 0)
Choice for the IGM absorption model. Options are: (a) 0 for Madau (1995), and (b) 1 for Inoue+(2014).</p></li>
<li><p><strong>likelihood</strong> – (default: ‘gauss’)
Choice of likelihood function for the RDSPS method. Only relevant if the fit_method=’rdsps’. Options are: (1)’gauss’, and (2) ‘student_t’.</p></li>
<li><p><strong>dof</strong> – (default: 2.0)
Degree of freedom (nu) in the Student’s likelihood function. Only relevant if the fit_method=’rdsps’ and likelihood=’student_t’.</p></li>
<li><p><strong>gauss_likelihood_form</strong> – (default: 0)
Choice for the Gaussian likelihood function. Options are: (1)0 for full/original form, and (2)1 for reduced/simplified form.
Only relevant for 2 cases: (1) fit_method=’rdsps’ and likelihood=’gauss’, and (2) fit_method=’mcmc’.
gauss_likelihood_form=0 means the Gaussian likelihood function uses the original/full Gaussian function form, whereas gauss_likelihood_form=1 means the likelihood function uses simplified form: P=exp(-0.5*chi^2).</p></li>
<li><p><strong>nwalkers</strong> – (default: 100)
Number of walkers to be set in the MCMC process. This parameter is only applicable if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps</strong> – (default: 600)
Number of steps for each walker in the MCMC process. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps_cut</strong> – (optional, default: 50)
Number of first steps of each walkers that will be cut when constructing the final sampler chains. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nproc</strong> – (default: 10)
Number of processors (cores) to be used in the calculation.</p></li>
<li><p><strong>perc_chi2</strong> – (optional, default: 90.0)
Lowest chi-square Percentage from the full model SEDs that are considered in the calculation of posterior-weighted averaging.
This parameter is only relevant for the RDSPS fitting method and it is not applicable for the MCMC method.</p></li>
<li><p><strong>cosmo</strong> – (default: 0)
Choices for the cosmology. Options are: (1)’flat_LCDM’ or 0, (2)’WMAP5’ or 1, (3)’WMAP7’ or 2, (4)’WMAP9’ or 3, (5)’Planck13’ or 4, (6)’Planck15’ or 5.
These options are similar to the choices available in the <a class="reference external" href="https://docs.astropy.org/en/stable/cosmology/#built-in-cosmologies">Astropy Cosmology</a> package.</p></li>
<li><p><strong>H0</strong> – (default: 70.0)
The Hubble constant at z=0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>Om0</strong> – (default: 0.3)
The Omega matter at z=0.0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>store_full_samplers</strong> – (default: 1 or True)
Flag indicating whether full sampler models will be stored into the output FITS file or not.
Options are: (a) 1 or True and (b) 0 or False.</p></li>
<li><p><strong>name_out_fits</strong> – (optional, default: [])
Names of output FITS files. This parameter is optional. If not empty, it must be in a list format with number of elements is the same as the number of bins to be fit.
Example: name_out_fits = [‘bin1.fits’, ‘bin2.fits’, …, ‘binN.fits’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="piXedfit.piXedfit_fitting.SEDfit_from_binmap_specphoto">
<code class="sig-prename descclassname">piXedfit.piXedfit_fitting.</code><code class="sig-name descname">SEDfit_from_binmap_specphoto</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fits_binmap</span></em>, <em class="sig-param"><span class="n">binid_range</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">bin_ids</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">models_spec</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fit_method</span><span class="o">=</span><span class="default_value">'mcmc'</span></em>, <em class="sig-param"><span class="n">gal_z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spec_sigma</span><span class="o">=</span><span class="default_value">2.6</span></em>, <em class="sig-param"><span class="n">poly_order</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">z_range</span><span class="o">=</span><span class="default_value">[0.0, 1.0]</span></em>, <em class="sig-param"><span class="n">nrands_z</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">add_igm_absorption</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">igm_type</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">likelihood</span><span class="o">=</span><span class="default_value">'gauss'</span></em>, <em class="sig-param"><span class="n">dof</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">gauss_likelihood_form</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">nwalkers</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">nsteps</span><span class="o">=</span><span class="default_value">600</span></em>, <em class="sig-param"><span class="n">nsteps_cut</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">nproc</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">perc_chi2</span><span class="o">=</span><span class="default_value">90.0</span></em>, <em class="sig-param"><span class="n">spec_chi_sigma_clip</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">cosmo</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">H0</span><span class="o">=</span><span class="default_value">70.0</span></em>, <em class="sig-param"><span class="n">Om0</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">del_wave_nebem</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">store_full_samplers</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">name_out_fits</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="headerlink" href="#piXedfit.piXedfit_fitting.SEDfit_from_binmap_specphoto" title="Permalink to this definition">¶</a></dt>
<dd><p>A function for performing SED fitting to set of spatially resolved SEDs from the reduced data cube that is produced after the pixel binning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_binmap</strong> – Input FITS file of reduced data cube after pixel binning. This FITS file is the one that is output by <code class="xref py py-func docutils literal notranslate"><span class="pre">pixel_binning_photo()</span></code> function in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">piXedfit_bin</span></code> module.
This is a mandatory parameter.</p></li>
<li><p><strong>binid_range</strong> – Range of bin IDs that are going to be fit. Allowed format is [idmin,idmax]. The id starts from 0. If empty, [], fitting will be done to SEDs of all spatial bins.</p></li>
<li><p><strong>bin_ids</strong> – Bin ids whose the SEDs are going to be fit. Allowed format is a 1D array. The id starts from 0. Both binid_range and bin_ids can’t be empty, []. If both of them are not empty, the bin_ids will be used.</p></li>
<li><p><strong>models_spec</strong> – (Mandatory)</p></li>
<li><p><strong>fit_method</strong> – (default: ‘mcmc’)
Choice for the fitting method. Options are: (1)’mcmc’, and (2)’rdsps’.</p></li>
<li><p><strong>gal_z</strong> – Redshift of the galaxy. If gal_z=None, then redshift is taken from the header of the FITS file.
If gal_z in the FITS file header is negatiive, then redshift is set to be free.</p></li>
<li><p><strong>spec_sigma</strong> – (default: 2.6)
Spectral resolution.</p></li>
<li><p><strong>poly_order</strong> – (default: 5.0)</p></li>
<li><p><strong>spec_chi_sigma_clip</strong> – </p></li>
<li><p><strong>z_range</strong> – (default: [0.0,1.0])</p></li>
<li><p><strong>nrands_z</strong> – (default: 10)</p></li>
<li><p><strong>add_igm_absorption</strong> – (default: 0)
Switch for the IGM absorption. Options are: (1)0 means turn off, and (2)1 means turn on.</p></li>
<li><p><strong>igm_type</strong> – (default: 0)
Choice for the IGM absorption model. Options are: (a) 0 for Madau (1995), and (b) 1 for Inoue+(2014).</p></li>
<li><p><strong>likelihood</strong> – (default: ‘gauss’)
Choice of likelihood function for the RDSPS method. Only relevant if the fit_method=’rdsps’. Options are: (1)’gauss’, and (2) ‘student_t’.</p></li>
<li><p><strong>dof</strong> – (default: 2.0)
Degree of freedom (nu) in the Student’s likelihood function. Only relevant if the fit_method=’rdsps’ and likelihood=’student_t’.</p></li>
<li><p><strong>gauss_likelihood_form</strong> – (default: 0)
Choice for the Gaussian likelihood function. Options are: (1)0 for full/original form, and (2)1 for reduced/simplified form.
Only relevant for 2 cases: (1) fit_method=’rdsps’ and likelihood=’gauss’, and (2) fit_method=’mcmc’.
gauss_likelihood_form=0 means the Gaussian likelihood function uses the original/full Gaussian function form, whereas gauss_likelihood_form=1 means the likelihood function uses simplified form: P=exp(-0.5*chi^2).</p></li>
<li><p><strong>nwalkers</strong> – (default: 100)
Number of walkers to be set in the MCMC process. This parameter is only applicable if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps</strong> – (default: 600)
Number of steps for each walker in the MCMC process. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps_cut</strong> – (optional, default: 50)
Number of first steps of each walkers that will be cut when constructing the final sampler chains. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nproc</strong> – (default: 10)
Number of processors (cores) to be used in the calculation.</p></li>
<li><p><strong>perc_chi2</strong> – (optional, default: 90.0)
Lowest chi-square Percentage from the full model SEDs that are considered in the calculation of posterior-weighted averaging.
This parameter is only relevant for the RDSPS fitting method and it is not applicable for the MCMC method.</p></li>
<li><p><strong>cosmo</strong> – <p>(default: 0)
Choices for the cosmology. Options are: (1)’flat_LCDM’ or 0, (2)’WMAP5’ or 1, (3)’WMAP7’ or 2, (4)’WMAP9’ or 3, (5)’Planck13’ or 4, (6)’Planck15’ or 5.
These options are similar to the choices available in the <a class="reference external" href="https://docs.astropy.org/en/stable/cosmology/#built-in-cosmologies">Astropy Cosmology</a> package.</p>
</p></li>
<li><p><strong>H0</strong> – (default: 70.0)
The Hubble constant at z=0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>Om0</strong> – (default: 0.3)
The Omega matter at z=0.0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>store_full_samplers</strong> – (default: 1 or True)
Flag indicating whether full sampler models will be stored into the output FITS file or not.
Options are: (a) 1 or True and (b) 0 or False.</p></li>
<li><p><strong>name_out_fits</strong> – (optional, default: [])
Names of output FITS files. This parameter is optional. If not empty, it must be in a list format with number of elements is the same as the number of bins to be fit.
Example: name_out_fits = [‘bin1.fits’, ‘bin2.fits’, …, ‘binN.fits’].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="piXedfit.piXedfit_fitting.SEDfit_pixels_from_fluxmap">
<code class="sig-prename descclassname">piXedfit.piXedfit_fitting.</code><code class="sig-name descname">SEDfit_pixels_from_fluxmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fits_fluxmap</span></em>, <em class="sig-param"><span class="n">x_range</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">y_range</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">models_spec</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">fit_method</span><span class="o">=</span><span class="default_value">'mcmc'</span></em>, <em class="sig-param"><span class="n">gal_z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">z_range</span><span class="o">=</span><span class="default_value">[0.0, 1.0]</span></em>, <em class="sig-param"><span class="n">nrands_z</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">add_igm_absorption</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">igm_type</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">likelihood</span><span class="o">=</span><span class="default_value">'gauss'</span></em>, <em class="sig-param"><span class="n">dof</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">gauss_likelihood_form</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">nwalkers</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">nsteps</span><span class="o">=</span><span class="default_value">600</span></em>, <em class="sig-param"><span class="n">nsteps_cut</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">nproc</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">cosmo</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">H0</span><span class="o">=</span><span class="default_value">70.0</span></em>, <em class="sig-param"><span class="n">Om0</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">perc_chi2</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">store_full_samplers</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#piXedfit.piXedfit_fitting.SEDfit_pixels_from_fluxmap" title="Permalink to this definition">¶</a></dt>
<dd><p>A function for performing SED fitting on pixel-by-pixel basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_fluxmap</strong> – Input FITS file of reduced 3D data cube of multiband fluxes. It is the ouput (or should have the same format as that of the output)
of the image processing by <code class="xref py py-func docutils literal notranslate"><span class="pre">images_processing()</span></code> function of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">piXedfit_images</span></code> module.</p></li>
<li><p><strong>x_range</strong> – Range of x-axis coordinate within which SED fitting will be performed to the pixels. The format is [xmin,xmax].
If x_range=[], the whole x-axis range of the data cube is considered.</p></li>
<li><p><strong>y_range</strong> – Range of y-axis coordinate within which SED fitting will be performed to the pixels. The format is [ymin,ymax].
If y_range=[], the whole y-axis range of the data cube is considered.</p></li>
<li><p><strong>models_spec</strong> – </p></li>
<li><p><strong>fit_method</strong> – (default: ‘mcmc’)
Choice for the fitting method. Options are: (1)’mcmc’, and (2)’rdsps’.</p></li>
<li><p><strong>gal_z</strong> – Redshift of the galaxy. If gal_z=None, then redshift is taken from the FITS file header.
If gal_z from the header is negative, then redshift is set to be free. <strong>As for the current version of **piXedfit</strong>, photo-z hasn’t been implemented**.</p></li>
<li><p><strong>z_range</strong> – </p></li>
<li><p><strong>nrands_z</strong> – </p></li>
<li><p><strong>add_igm_absorption</strong> – (default: 0)
Switch for the IGM absorption. Options are: (1)0 means turn off, and (2)1 means turn on.</p></li>
<li><p><strong>igm_type</strong> – (default: 0)
Choice for the IGM absorption model. Options are: (a) 0 for Madau (1995), and (b) 1 for Inoue+(2014).</p></li>
<li><p><strong>likelihood</strong> – (default: ‘gauss’)
Choice of likelihood function for the RDSPS method. Only relevant if the fit_method=’rdsps’. Options are: (1)’gauss’, and (2) ‘student_t’.</p></li>
<li><p><strong>dof</strong> – (default: 2.0)
Degree of freedom (nu) in the Student’s likelihood function. Only relevant if the fit_method=’rdsps’ and likelihood=’student_t’.</p></li>
<li><p><strong>gauss_likelihood_form</strong> – (default: 0)
Choice for the Gaussian likelihood function. Options are: (1)0 for full/original form, and (2)1 for reduced/simplified form.
Only relevant for 2 cases: (1) fit_method=’rdsps’ and likelihood=’gauss’, and (2) fit_method=’mcmc’.
gauss_likelihood_form=0 means the Gaussian likelihood function uses the original/full Gaussian function form, whereas gauss_likelihood_form=1 means the likelihood function uses simplified form: P=exp(-0.5*chi^2).</p></li>
<li><p><strong>nwalkers</strong> – (default: 100)
Number of walkers to be set in the MCMC process. This parameter is only applicable if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps</strong> – (default: 600)
Number of steps for each walker in the MCMC process. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps_cut</strong> – (optional, default: 50)
Number of first steps of each walkers that will be cut when constructing the final sampler chains. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nproc</strong> – (default: 10)
Number of processors (cores) to be used in the calculation.</p></li>
<li><p><strong>cosmo</strong> – <p>(default: 0)
Choices for the cosmology. Options are: (1)’flat_LCDM’ or 0, (2)’WMAP5’ or 1, (3)’WMAP7’ or 2, (4)’WMAP9’ or 3, (5)’Planck13’ or 4, (6)’Planck15’ or 5.
These options are similar to the choices available in the <a class="reference external" href="https://docs.astropy.org/en/stable/cosmology/#built-in-cosmologies">Astropy Cosmology</a> package.</p>
</p></li>
<li><p><strong>H0</strong> – (default: 70.0)
The Hubble constant at z=0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>Om0</strong> – (default: 0.3)
The Omega matter at z=0.0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>perc_chi2</strong> – (default: 10.0)
Lowest chi-square Percentage from the full model SEDs that are considered in the calculation of posterior-weighted averaging.
This parameter is only relevant for the RDSPS fitting method and it is not applicable for the MCMC method.</p></li>
<li><p><strong>store_full_samplers</strong> – (default: 1 or True)
Flag indicating whether full sampler models will be stored into the output FITS file or not.
Options are: (a) 1 or True and (b) 0 or False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="piXedfit.piXedfit_fitting.inferred_params_mcmc_list">
<code class="sig-prename descclassname">piXedfit.piXedfit_fitting.</code><code class="sig-name descname">inferred_params_mcmc_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_name_fits</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">name_out_fits</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#piXedfit.piXedfit_fitting.inferred_params_mcmc_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for calculating inferred parameters (i.e., median posteriors) of fitting results.
The expected input is a list of FITS files contining the MCMC samplers which are output of <a class="reference internal" href="#piXedfit.piXedfit_fitting.singleSEDfit" title="piXedfit.piXedfit_fitting.singleSEDfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">singleSEDfit()</span></code></a> or <a class="reference internal" href="#piXedfit.piXedfit_fitting.SEDfit_from_binmap" title="piXedfit.piXedfit_fitting.SEDfit_from_binmap"><code class="xref py py-func docutils literal notranslate"><span class="pre">SEDfit_from_binmap()</span></code></a> functions.
The output of this function is a FITS file containing summary of inferred parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_name_fits</strong> – (Mandatory, default=[])
List of names of the input FITS files. The FITS files are output of fitting with MCMC method using <a class="reference internal" href="#piXedfit.piXedfit_fitting.singleSEDfit" title="piXedfit.piXedfit_fitting.singleSEDfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">singleSEDfit()</span></code></a> or <a class="reference internal" href="#piXedfit.piXedfit_fitting.SEDfit_from_binmap" title="piXedfit.piXedfit_fitting.SEDfit_from_binmap"><code class="xref py py-func docutils literal notranslate"><span class="pre">SEDfit_from_binmap()</span></code></a> functions.
All the FITS files should have identical structure. In other word, they are results of fitting with the same set of free parameters.</p></li>
<li><p><strong>name_out_fits</strong> – (optional, default: None)
Desired name for the output FITS file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="piXedfit.piXedfit_fitting.inferred_params_rdsps_list">
<code class="sig-prename descclassname">piXedfit.piXedfit_fitting.</code><code class="sig-name descname">inferred_params_rdsps_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_name_fits</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">perc_chi2</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">name_out_fits</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#piXedfit.piXedfit_fitting.inferred_params_rdsps_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for calculating inferred parameters (i.e., median posteriors) of fitting results obtained with RDSPS method.
The expected input is a list of FITS files contining the model properties which are output of <a class="reference internal" href="#piXedfit.piXedfit_fitting.singleSEDfit" title="piXedfit.piXedfit_fitting.singleSEDfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">singleSEDfit()</span></code></a> or <a class="reference internal" href="#piXedfit.piXedfit_fitting.SEDfit_from_binmap" title="piXedfit.piXedfit_fitting.SEDfit_from_binmap"><code class="xref py py-func docutils literal notranslate"><span class="pre">SEDfit_from_binmap()</span></code></a> functions.
The output of this function is a FITS file containing summary of inferred parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list_name_fits</strong> – (Mandatory, default=[])
List of names of the input FITS files. The FITS files are output of fitting with RDSPS method using <a class="reference internal" href="#piXedfit.piXedfit_fitting.singleSEDfit" title="piXedfit.piXedfit_fitting.singleSEDfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">singleSEDfit()</span></code></a> or <a class="reference internal" href="#piXedfit.piXedfit_fitting.SEDfit_from_binmap" title="piXedfit.piXedfit_fitting.SEDfit_from_binmap"><code class="xref py py-func docutils literal notranslate"><span class="pre">SEDfit_from_binmap()</span></code></a> functions.
All the FITS files should have identical structure. In other word, they are results of fitting with the same set of free parameters.</p></li>
<li><p><strong>perc_chi2</strong> – (default: 10.0)
Lowest chi-square Percentage from the full model SEDs that are considered in the calculation of posterior-weighted averaging.</p></li>
<li><p><strong>name_out_fits</strong> – (default: None)
Desired name for the output FITS file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="piXedfit.piXedfit_fitting.maps_parameters">
<code class="sig-prename descclassname">piXedfit.piXedfit_fitting.</code><code class="sig-name descname">maps_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fits_binmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bin_ids</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">name_sampler_fits</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">fits_fluxmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">refband_SFR</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">refband_SM</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">refband_Mdust</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">perc_chi2</span><span class="o">=</span><span class="default_value">80.0</span></em>, <em class="sig-param"><span class="n">name_out_fits</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#piXedfit.piXedfit_fitting.maps_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that can be used for constructing maps of properties from the fitting results of spatial bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_binmap</strong> – (Mandatory, default=None)
FITS file containing the reduced data after the pixel binning process, which is output of the <code class="xref py py-func docutils literal notranslate"><span class="pre">pixel_binning_photo()</span></code> function in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">piXedfit_bin</span></code> module.</p></li>
<li><p><strong>bin_ids</strong> – Bin indices of the FITS files listed in name_sampler_fits input. Allowed format is a 1D array. The id starts from 0.</p></li>
<li><p><strong>name_sampler_fits</strong> – List of the names of the FITS files containing the fitting results of spatial bins. This should have the same number of element as that of bin_ids.
The number of element doesn’t necessarily the same as the number of bins. A missing bin will be ignored in the creation of the maps of properties.</p></li>
<li><p><strong>fits_fluxmap</strong> – (Mandatory, default: None)
FITS file containing reduced maps of multiband fluxes, which is output of the <code class="xref py py-func docutils literal notranslate"><span class="pre">flux_map()</span></code> in the <code class="xref py py-class docutils literal notranslate"><span class="pre">images_processing</span></code> class in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">piXedfit_images</span></code> module.</p></li>
<li><p><strong>refband_SFR</strong> – (default: None)
Index of band in the multiband set that is used for reference in dividing map of SFR in bin space into map of SFR in pixel space.
If None, the band with shortest wavelength is selected.</p></li>
<li><p><strong>refband_SM</strong> – (default: None)
Index of band in the multiband set that is used for reference in dividing map of stellar mass in bin space into map of stellar mass in pixel space.
If None, the band with longest wavelength is selected.</p></li>
<li><p><strong>refband_Mdust</strong> – (default: None)
Index of band/filter in the multiband set that is used for reference in dividing map of dust mass in bin space into map of dust mass in pixel space.
If None, the band with longest wavelength is selected.</p></li>
<li><p><strong>perc_chi2</strong> – (optional, default=80.0)
A parameter that set the percentile cut of the random model SEDs. The cut is applied after the models are sorted based on their chi-square values.
This parameter defines up to what percentile the models will be cut. This parameter is only used if the fitting results are obtained with the RDSPS method.</p></li>
<li><p><strong>name_out_fits</strong> – (optional, default: None)
Desired name for the output FITS file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="piXedfit.piXedfit_fitting.maps_parameters_fit_pixels">
<code class="sig-prename descclassname">piXedfit.piXedfit_fitting.</code><code class="sig-name descname">maps_parameters_fit_pixels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fits_fluxmap</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pix_x</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">pix_y</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">name_sampler_fits</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">perc_chi2</span><span class="o">=</span><span class="default_value">80.0</span></em>, <em class="sig-param"><span class="n">name_out_fits</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#piXedfit.piXedfit_fitting.maps_parameters_fit_pixels" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for calculating maps of properties from the fitting results obtained with the MCMC method on pixel basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_fluxmap</strong> – FITS file containing reduced maps of multiband fluxes, which is output of the <code class="xref py py-func docutils literal notranslate"><span class="pre">flux_map()</span></code> in the <code class="xref py py-class docutils literal notranslate"><span class="pre">images_processing</span></code> class in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">piXedfit_images</span></code> module.</p></li>
<li><p><strong>pix_x</strong> – x coordinates of pixels associated with the FITS files (fitting results) in name_sampler_fits input.</p></li>
<li><p><strong>pix_y</strong> – y coordinates of pixels associated with the FITS files (fitting results) in name_sampler_fits input.</p></li>
<li><p><strong>name_sampler_fits</strong> – List of names of the FITS files containing the fitting results.
The three inputs of pix_x, pix_y, and name_sampler_fits should have the same number of elements.</p></li>
<li><p><strong>perc_chi2</strong> – (optional, default=80.0)
A parameter that set the percentile cut of the random model SEDs. The cut is applied after the models are sorted based on their chi-square values.
This parameter defines up to what percentile the models will be cut. This parameter is only used if the fitting results are obtained with the RDSPS method.</p></li>
<li><p><strong>name_out_fits</strong> – (optional, default: None)
Desired name for the output FITS file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="piXedfit.piXedfit_fitting.singleSEDfit">
<code class="sig-prename descclassname">piXedfit.piXedfit_fitting.</code><code class="sig-name descname">singleSEDfit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs_flux</span></em>, <em class="sig-param"><span class="n">obs_flux_err</span></em>, <em class="sig-param"><span class="n">filters</span></em>, <em class="sig-param"><span class="n">models_spec</span></em>, <em class="sig-param"><span class="n">fit_method</span><span class="o">=</span><span class="default_value">'mcmc'</span></em>, <em class="sig-param"><span class="n">gal_z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">z_range</span><span class="o">=</span><span class="default_value">[0.0, 1.0]</span></em>, <em class="sig-param"><span class="n">nrands_z</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">add_igm_absorption</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">igm_type</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">likelihood</span><span class="o">=</span><span class="default_value">'gauss'</span></em>, <em class="sig-param"><span class="n">dof</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">gauss_likelihood_form</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">nwalkers</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">nsteps</span><span class="o">=</span><span class="default_value">600</span></em>, <em class="sig-param"><span class="n">nsteps_cut</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">nproc</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">perc_chi2</span><span class="o">=</span><span class="default_value">90.0</span></em>, <em class="sig-param"><span class="n">cosmo</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">H0</span><span class="o">=</span><span class="default_value">70.0</span></em>, <em class="sig-param"><span class="n">Om0</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">store_full_samplers</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">name_out_fits</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#piXedfit.piXedfit_fitting.singleSEDfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for performing SED fitting to a single photometric SED.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_flux</strong> – 1D array containing the multiband fluxes. The number of elements should be the same as that of the input filters.</p></li>
<li><p><strong>obs_flux_err</strong> – 1D array containing the multiband flux errors. The number of elements should be the same as that of the input filters.</p></li>
<li><p><strong>filters</strong> – List of photometric filters names. The accepted naming for the filters can be seen using <code class="xref py py-func docutils literal notranslate"><span class="pre">list_filters()</span></code> function in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">utils.filtering</span></code> module.</p></li>
<li><p><strong>models_spec</strong> – </p></li>
<li><p><strong>fit_method</strong> – (default: ‘mcmc’)
Choice for the fitting method. Options are: (1)’mcmc’, and (2)’rdsps’.</p></li>
<li><p><strong>gal_z</strong> – Redshift of the galaxy. If gal_z=None, then redshift is set to be a free parameter in the fitting. As for the current version of <strong>piXedfit</strong>, photo-z hasn’t been implemented.</p></li>
<li><p><strong>z_range</strong> – (default: [0.0,1.0])</p></li>
<li><p><strong>nrands_z</strong> – (default: 10)</p></li>
<li><p><strong>add_igm_absorption</strong> – (default: 0)
Switch for the IGM absorption. Options are: (1)0 means turn off, and (2)1 means turn on.</p></li>
<li><p><strong>igm_type</strong> – (default: 0)
Choice for the IGM absorption model. Options are: (a) 0 for Madau (1995), and (b) 1 for Inoue+(2014).</p></li>
<li><p><strong>likelihood</strong> – (default: ‘gauss’)
Choice of likelihood function for the RDSPS method. Only relevant if the fit_method=’rdsps’. Options are: (1)’gauss’, and (2) ‘student_t’.</p></li>
<li><p><strong>dof</strong> – (default: 2.0)
Degree of freedom (nu) in the Student’s likelihood function. Only relevant if the fit_method=’rdsps’ and likelihood=’student_t’.</p></li>
<li><p><strong>gauss_likelihood_form</strong> – (default: 0)
Choice for the Gaussian likelihood function. Options are: (1)0 for full/original form, and (2)1 for reduced/simplified form.
Only relevant for 2 cases: (1) fit_method=’rdsps’ and likelihood=’gauss’, and (2) fit_method=’mcmc’.
gauss_likelihood_form=0 means the Gaussian likelihood function uses the original/full Gaussian function form, whereas gauss_likelihood_form=1 means the likelihood function uses simplified form: P=exp(-0.5*chi^2).</p></li>
<li><p><strong>nwalkers</strong> – (default: 100)
Number of walkers to be set in the MCMC process. This parameter is only applicable if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps</strong> – (default: 600)
Number of steps for each walker in the MCMC process. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps_cut</strong> – (default: 50)
Number of first steps of each walkers that will be cut when constructing the final sampler chains. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nproc</strong> – (default: 10)
Number of processors (cores) to be used in the calculation.</p></li>
<li><p><strong>perc_chi2</strong> – (default: 90.0)
Lowest chi-square Percentage from the full model SEDs that are considered in the calculation of posterior-weighted averaging.
This parameter is only relevant for the RDSPS fitting method and it is not applicable for the MCMC method.</p></li>
<li><p><strong>cosmo</strong> – <p>(default: 0)
Choices for the cosmology. Options are: (1)’flat_LCDM’ or 0, (2)’WMAP5’ or 1, (3)’WMAP7’ or 2, (4)’WMAP9’ or 3, (5)’Planck13’ or 4, (6)’Planck15’ or 5.
These options are similar to the choices available in the <a class="reference external" href="https://docs.astropy.org/en/stable/cosmology/#built-in-cosmologies">Astropy Cosmology</a> package.</p>
</p></li>
<li><p><strong>H0</strong> – (default: 70.0)
The Hubble constant at z=0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>Om0</strong> – (default: 0.3)
The Omega matter at z=0.0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>store_full_samplers</strong> – (default: 1 or True)
Flag indicating whether full sampler models will be stored into the output FITS file or not.
Options are: (a) 1 or True and (b) 0 or False.</p></li>
<li><p><strong>name_out_fits</strong> – (optional, default: None)
Name of output FITS file. This parameter is optional.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="piXedfit.piXedfit_fitting.singleSEDfit_specphoto">
<code class="sig-prename descclassname">piXedfit.piXedfit_fitting.</code><code class="sig-name descname">singleSEDfit_specphoto</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs_flux</span></em>, <em class="sig-param"><span class="n">obs_flux_err</span></em>, <em class="sig-param"><span class="n">filters</span></em>, <em class="sig-param"><span class="n">spec_wave</span></em>, <em class="sig-param"><span class="n">spec_flux</span></em>, <em class="sig-param"><span class="n">spec_flux_err</span></em>, <em class="sig-param"><span class="n">models_spec</span></em>, <em class="sig-param"><span class="n">fit_method</span><span class="o">=</span><span class="default_value">'mcmc'</span></em>, <em class="sig-param"><span class="n">gal_z</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spec_sigma</span><span class="o">=</span><span class="default_value">2.6</span></em>, <em class="sig-param"><span class="n">poly_order</span><span class="o">=</span><span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">z_range</span><span class="o">=</span><span class="default_value">[0.0, 1.0]</span></em>, <em class="sig-param"><span class="n">nrands_z</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">add_igm_absorption</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">igm_type</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">likelihood</span><span class="o">=</span><span class="default_value">'gauss'</span></em>, <em class="sig-param"><span class="n">dof</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">gauss_likelihood_form</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">nwalkers</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">nsteps</span><span class="o">=</span><span class="default_value">600</span></em>, <em class="sig-param"><span class="n">nsteps_cut</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">nproc</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">perc_chi2</span><span class="o">=</span><span class="default_value">90.0</span></em>, <em class="sig-param"><span class="n">spec_chi_sigma_clip</span><span class="o">=</span><span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">cosmo</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">H0</span><span class="o">=</span><span class="default_value">70.0</span></em>, <em class="sig-param"><span class="n">Om0</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">del_wave_nebem</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">store_full_samplers</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">name_out_fits</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#piXedfit.piXedfit_fitting.singleSEDfit_specphoto" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for performing SED fitting to a single photometric SED.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_flux</strong> – 1D array containing the multiband fluxes. The number of elements should be the same as that of the input filters.</p></li>
<li><p><strong>obs_flux_err</strong> – 1D array containing the multiband flux errors. The number of elements should be the same as that of the input filters.</p></li>
<li><p><strong>filters</strong> – List of photometric filters names. The accepted naming for the filters can be seen using <code class="xref py py-func docutils literal notranslate"><span class="pre">list_filters()</span></code> function in the <code class="xref py py-mod docutils literal notranslate"><span class="pre">utils.filtering</span></code> module.</p></li>
<li><p><strong>spec_wave</strong> – </p></li>
<li><p><strong>spec_flux</strong> – </p></li>
<li><p><strong>spec_flux_err</strong> – </p></li>
<li><p><strong>models_spec</strong> – </p></li>
<li><p><strong>fit_method</strong> – (default: ‘mcmc’)
Choice for the fitting method. Options are: (1)’mcmc’, and (2)’rdsps’.</p></li>
<li><p><strong>gal_z</strong> – Redshift of the galaxy. If gal_z=None, then redshift is set to be a free parameter in the fitting. As for the current version of <strong>piXedfit</strong>, photo-z hasn’t been implemented.</p></li>
<li><p><strong>spec_sigma</strong> – </p></li>
<li><p><strong>poly_order</strong> – </p></li>
<li><p><strong>z_range</strong> – (default: [0.0,1.0])</p></li>
<li><p><strong>nrands_z</strong> – (default: 10)</p></li>
<li><p><strong>add_igm_absorption</strong> – (default: 0)
Switch for the IGM absorption. Options are: (1)0 means turn off, and (2)1 means turn on.</p></li>
<li><p><strong>igm_type</strong> – (default: 0)
Choice for the IGM absorption model. Options are: (a) 0 for Madau (1995), and (b) 1 for Inoue+(2014).</p></li>
<li><p><strong>likelihood</strong> – (default: ‘gauss’)
Choice of likelihood function for the RDSPS method. Only relevant if the fit_method=’rdsps’. Options are: (1)’gauss’, and (2) ‘student_t’.</p></li>
<li><p><strong>dof</strong> – (default: 2.0)
Degree of freedom (nu) in the Student’s likelihood function. Only relevant if the fit_method=’rdsps’ and likelihood=’student_t’.</p></li>
<li><p><strong>gauss_likelihood_form</strong> – (default: 0)
Choice for the Gaussian likelihood function. Options are: (1)0 for full/original form, and (2)1 for reduced/simplified form.
Only relevant for 2 cases: (1) fit_method=’rdsps’ and likelihood=’gauss’, and (2) fit_method=’mcmc’.
gauss_likelihood_form=0 means the Gaussian likelihood function uses the original/full Gaussian function form, whereas gauss_likelihood_form=1 means the likelihood function uses simplified form: P=exp(-0.5*chi^2).</p></li>
<li><p><strong>nwalkers</strong> – (default: 100)
Number of walkers to be set in the MCMC process. This parameter is only applicable if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps</strong> – (default: 600)
Number of steps for each walker in the MCMC process. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nsteps_cut</strong> – (default: 50)
Number of first steps of each walkers that will be cut when constructing the final sampler chains. Only relevant if fit_method=’mcmc’.</p></li>
<li><p><strong>nproc</strong> – (default: 10)
Number of processors (cores) to be used in the calculation.</p></li>
<li><p><strong>perc_chi2</strong> – (default: 90.0)
Lowest chi-square Percentage from the full model SEDs that are considered in the calculation of posterior-weighted averaging.
This parameter is only relevant for the RDSPS fitting method and it is not applicable for the MCMC method.</p></li>
<li><p><strong>spec_chi_sigma_clip</strong> – (default: 3.0)</p></li>
<li><p><strong>cosmo</strong> – <p>(default: 0)
Choices for the cosmology. Options are: (1)’flat_LCDM’ or 0, (2)’WMAP5’ or 1, (3)’WMAP7’ or 2, (4)’WMAP9’ or 3, (5)’Planck13’ or 4, (6)’Planck15’ or 5.
These options are similar to the choices available in the <a class="reference external" href="https://docs.astropy.org/en/stable/cosmology/#built-in-cosmologies">Astropy Cosmology</a> package.</p>
</p></li>
<li><p><strong>H0</strong> – (default: 70.0)
The Hubble constant at z=0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>Om0</strong> – (default: 0.3)
The Omega matter at z=0.0. Only relevant when cosmo=’flat_LCDM’ is chosen.</p></li>
<li><p><strong>del_wave_nebem</strong> – </p></li>
<li><p><strong>store_full_samplers</strong> – (default: 1 or True)
Flag indicating whether full sampler models will be stored into the output FITS file or not.
Options are: (a) 1 or True and (b) 0 or False.</p></li>
<li><p><strong>name_out_fits</strong> – (optional, default: None)
Name of output FITS file. This parameter is optional.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="piXedfit_analysis.html" class="btn btn-neutral float-right" title="piXedfit_analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="piXedfit_model.html" class="btn btn-neutral float-left" title="piXedfit_model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Abdurro&#39;uf

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>